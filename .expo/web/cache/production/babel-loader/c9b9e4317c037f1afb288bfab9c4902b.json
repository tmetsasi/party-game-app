{"ast":null,"code":"import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import View from\"react-native-web/dist/exports/View\";import Button from\"react-native-web/dist/exports/Button\";import Text from\"react-native-web/dist/exports/Text\";import Modal from\"react-native-web/dist/exports/Modal\";import SafeAreaView from\"react-native-web/dist/exports/SafeAreaView\";import ActivityIndicator from\"react-native-web/dist/exports/ActivityIndicator\";import FlatList from\"react-native-web/dist/exports/FlatList\";import InlineTextButton from\"../components/InlineTextButton\";import AppStyles from\"../styles/AppStyles\";import{auth,db}from\"../firebase\";import{collection,addDoc,query,where,getDocs,deleteDoc,doc,setDoc}from\"firebase/firestore\";import{sendEmailVerification}from'firebase/auth';import React from'react';import AddToDoModal from\"../components/AddToDoModal\";import BouncyCheckbox from'react-native-bouncy-checkbox';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function ToDo(_ref){var navigation=_ref.navigation;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),modalVisible=_React$useState2[0],setModalVisible=_React$useState2[1];var _React$useState3=React.useState(true),_React$useState4=_slicedToArray(_React$useState3,2),isLoading=_React$useState4[0],setIsLoading=_React$useState4[1];var _React$useState5=React.useState(false),_React$useState6=_slicedToArray(_React$useState5,2),isRefreshing=_React$useState6[0],setIsRefreshing=_React$useState6[1];var _React$useState7=React.useState([]),_React$useState8=_slicedToArray(_React$useState7,2),toDos=_React$useState8[0],setToDos=_React$useState8[1];var loadToDoList=function(){var _ref2=_asyncToGenerator(function*(){var q=query(collection(db,\"todos\"),where(\"userId\",\"==\",auth.currentUser.uid));var querySnapshot=yield getDocs(q);var toDos=[];querySnapshot.forEach(function(doc){var toDo=doc.data();toDo.id=doc.id;toDos.push(toDo);});setToDos(toDos);setIsLoading(false);setIsRefreshing(false);});return function loadToDoList(){return _ref2.apply(this,arguments);};}();if(isLoading){loadToDoList();}var checkToDoItem=function checkToDoItem(item,isChecked){var toDoRef=doc(db,'todos',item.id);setDoc(toDoRef,{completed:isChecked},{merge:true});};var deleteToDo=function(){var _ref3=_asyncToGenerator(function*(toDoId){yield deleteDoc(doc(db,\"todos\",toDoId));var updatedToDos=_toConsumableArray(toDos).filter(function(item){return item.id!=toDoId;});setToDos(updatedToDos);});return function deleteToDo(_x){return _ref3.apply(this,arguments);};}();var renderToDoItem=function renderToDoItem(_ref4){var item=_ref4.item;return _jsxs(View,{style:[AppStyles.rowContainer,AppStyles.rightMargin,AppStyles.leftMargin],children:[_jsx(View,{style:AppStyles.fillSpace,children:_jsx(BouncyCheckbox,{isChecked:item.complated,size:25,fillColor:\"#258ea6\",unfillColor:\"#FFFFFF\",text:item.text,iconStyle:{borderColor:\"#258ea6\"},onPress:function onPress(isChecked){checkToDoItem(item,isChecked);}})}),_jsx(InlineTextButton,{text:\"Delete\",color:\"#258ea6\",onPress:function onPress(){return deleteToDo(item.id);}})]});};var showToDoList=function showToDoList(){return _jsx(FlatList,{data:toDos,refreshing:isRefreshing,onRefresh:function onRefresh(){loadToDoList();setIsRefreshing(true);},renderItem:renderToDoItem,keyExtractor:function keyExtractor(item){return item.id;}});};var showContent=function showContent(){return _jsxs(View,{children:[isLoading?_jsx(ActivityIndicator,{size:\"large\"}):showToDoList(),_jsx(Button,{title:\"Add ToDo\",onPress:function onPress(){return setModalVisible(true);},color:\"#fb4d3d\"})]});};var showSendVerificationEmail=function showSendVerificationEmail(){return _jsxs(View,{children:[_jsx(Text,{children:\"Please verify your email to use ToDo\"}),_jsx(Button,{title:\"Send Verification Email\",onPress:function onPress(){return sendEmailVerification(auth.currentUser);}})]});};var addToDo=function(){var _ref5=_asyncToGenerator(function*(todo){var toDoToSave={text:todo,completed:false,userId:auth.currentUser.uid};var docRef=yield addDoc(collection(db,\"todos\"),toDoToSave);toDoToSave.id=docRef.id;var updatedToDos=_toConsumableArray(toDos);updatedToDos.push(toDoToSave);setToDos(updatedToDos);});return function addToDo(_x2){return _ref5.apply(this,arguments);};}();return _jsxs(SafeAreaView,{children:[_jsx(View,{style:[AppStyles.rowContainer,AppStyles.rightAligned,AppStyles.rightMargin,AppStyles.topMargin],children:_jsx(InlineTextButton,{text:\"Manage Account\",color:\"#258ea6\",onPress:function onPress(){return navigation.navigate(\"ManageAccount\");}})}),_jsx(Modal,{animationType:\"slide\",transparent:true,visible:modalVisible,onRequestClose:function onRequestClose(){return setModalVisible(false);},children:_jsx(AddToDoModal,{onClose:function onClose(){return setModalVisible(false);},addToDo:addToDo})}),_jsx(Text,{style:AppStyles.header,children:\"ToDo\"}),auth.currentUser.emailVerified?showContent():showSendVerificationEmail()]});}","map":{"version":3,"names":["InlineTextButton","AppStyles","auth","db","collection","addDoc","query","where","getDocs","deleteDoc","doc","setDoc","sendEmailVerification","React","AddToDoModal","BouncyCheckbox","ToDo","navigation","useState","modalVisible","setModalVisible","isLoading","setIsLoading","isRefreshing","setIsRefreshing","toDos","setToDos","loadToDoList","q","currentUser","uid","querySnapshot","forEach","toDo","data","id","push","checkToDoItem","item","isChecked","toDoRef","completed","merge","deleteToDo","toDoId","updatedToDos","filter","renderToDoItem","rowContainer","rightMargin","leftMargin","fillSpace","complated","text","borderColor","showToDoList","showContent","showSendVerificationEmail","addToDo","todo","toDoToSave","userId","docRef","rightAligned","topMargin","navigate","header","emailVerified"],"sources":["/Users/tmetsasi/Desktop/Projects/PartyGame/party-game-app/screens/ToDo.js"],"sourcesContent":["import { View, Button, Text, Modal, SafeAreaView, ActivityIndicator, FlatList } from 'react-native';\nimport InlineTextButton from '../components/InlineTextButton';\nimport AppStyles from '../styles/AppStyles';\nimport { auth, db } from \"../firebase\";\nimport { collection, addDoc, query, where, getDocs, deleteDoc, doc, setDoc } from \"firebase/firestore\"; \nimport { sendEmailVerification } from 'firebase/auth';\nimport React from 'react';\nimport AddToDoModal from '../components/AddToDoModal';\nimport BouncyCheckbox from 'react-native-bouncy-checkbox';\n\nexport default function ToDo({ navigation }) {\n  let [modalVisible, setModalVisible] = React.useState(false);\n  let [isLoading, setIsLoading] = React.useState(true);\n  let [isRefreshing, setIsRefreshing] = React.useState(false);\n  let [toDos, setToDos] = React.useState([]);\n\n  let loadToDoList = async () => {\n    const q = query(collection(db, \"todos\"), where(\"userId\", \"==\", auth.currentUser.uid));\n\n    const querySnapshot = await getDocs(q);\n    let toDos = [];\n    querySnapshot.forEach((doc) => {\n      let toDo = doc.data();\n      toDo.id = doc.id;\n      toDos.push(toDo);\n    });\n\n    setToDos(toDos);\n    setIsLoading(false);\n    setIsRefreshing(false);\n  };\n\n  if (isLoading) {\n    loadToDoList();\n  }\n\n  let checkToDoItem = (item, isChecked) => {\n    const toDoRef = doc(db, 'todos', item.id);\n    setDoc(toDoRef, { completed: isChecked }, { merge: true });\n  };\n\n  let deleteToDo = async (toDoId) => {\n    await deleteDoc(doc(db, \"todos\", toDoId));\n    let updatedToDos = [...toDos].filter((item) => item.id != toDoId);\n    setToDos(updatedToDos);\n  };\n\n  let renderToDoItem = ({item}) => {\n    return (\n      <View style={[AppStyles.rowContainer, AppStyles.rightMargin, AppStyles.leftMargin]}>\n        <View style={AppStyles.fillSpace}>\n          <BouncyCheckbox\n            isChecked={item.complated}\n            size={25}\n            fillColor=\"#258ea6\"\n            unfillColor=\"#FFFFFF\"\n            text={item.text}\n            iconStyle={{ borderColor: \"#258ea6\" }}\n            onPress={(isChecked) => { checkToDoItem(item, isChecked)}}\n          />\n        </View>\n        <InlineTextButton text=\"Delete\" color=\"#258ea6\" onPress={() => deleteToDo(item.id)} />\n      </View>\n    );\n  }\n\n  let showToDoList = () => {\n    return (\n      <FlatList\n        data={toDos}\n        refreshing={isRefreshing}\n        onRefresh={() => {\n          loadToDoList();\n          setIsRefreshing(true);\n        }}\n        renderItem={renderToDoItem}\n        keyExtractor={item => item.id} />\n    )\n  };\n\n  let showContent = () => {\n    return (\n      <View>\n        {isLoading ? <ActivityIndicator size=\"large\" /> : showToDoList() }\n        <Button \n          title=\"Add ToDo\" \n          onPress={() => setModalVisible(true)} \n          color=\"#fb4d3d\" />\n      </View>\n    );\n  };\n\n  let showSendVerificationEmail = () => {\n    return (\n      <View>\n        <Text>Please verify your email to use ToDo</Text>\n        <Button title=\"Send Verification Email\" onPress={() => sendEmailVerification(auth.currentUser)} />\n      </View>\n    );\n  };\n\n  let addToDo = async (todo) => {\n    let toDoToSave = {\n      text: todo,\n      completed: false,\n      userId: auth.currentUser.uid\n    };\n    const docRef = await addDoc(collection(db, \"todos\"), toDoToSave);\n\n    toDoToSave.id = docRef.id;\n\n    let updatedToDos = [...toDos];\n    updatedToDos.push(toDoToSave);\n\n    setToDos(updatedToDos);\n  };\n  \n  return (\n    <SafeAreaView>\n      <View style={[AppStyles.rowContainer, AppStyles.rightAligned, AppStyles.rightMargin, AppStyles.topMargin]}>\n        <InlineTextButton text=\"Manage Account\" color=\"#258ea6\" onPress={() => navigation.navigate(\"ManageAccount\")}/>\n      </View>\n      <Modal\n        animationType=\"slide\"\n        transparent={true}\n        visible={modalVisible}\n        onRequestClose={() => setModalVisible(false)}>\n        <AddToDoModal \n          onClose={() => setModalVisible(false)}\n          addToDo={addToDo} />\n      </Modal>\n      <Text style={AppStyles.header}>ToDo</Text>\n      {auth.currentUser.emailVerified ? showContent() : showSendVerificationEmail()}\n    </SafeAreaView>\n  )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}